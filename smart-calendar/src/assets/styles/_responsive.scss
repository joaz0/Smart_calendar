// Advanced Responsive System
@use 'breakpoints' as *;

// Container Queries (Modern approach)
@mixin container-query($min-width) {
  @container (min-width: #{$min-width}) {
    @content;
  }
}

// Responsive Typography Scale
@mixin responsive-text($mobile-size, $desktop-size) {
  font-size: $mobile-size;
  
  @include desktop-only {
    font-size: $desktop-size;
  }
}

// Fluid Typography
@mixin fluid-type($min-size, $max-size, $min-vw: 320px, $max-vw: 1200px) {
  font-size: clamp(#{$min-size}, #{$min-size} + (#{strip-unit($max-size)} - #{strip-unit($min-size)}) * ((100vw - #{$min-vw}) / (#{strip-unit($max-vw)} - #{strip-unit($min-vw)})), #{$max-size});
}

// Responsive Spacing
@mixin responsive-padding($mobile, $desktop) {
  padding: $mobile;
  
  @include desktop-only {
    padding: $desktop;
  }
}

@mixin responsive-margin($mobile, $desktop) {
  margin: $mobile;
  
  @include desktop-only {
    margin: $desktop;
  }
}

// Grid Systems
@mixin responsive-grid($mobile-cols: 1, $tablet-cols: 2, $desktop-cols: 3) {
  display: grid;
  gap: var(--space-4);
  grid-template-columns: repeat($mobile-cols, 1fr);
  
  @include tablet-only {
    grid-template-columns: repeat($tablet-cols, 1fr);
  }
  
  @include desktop-only {
    grid-template-columns: repeat($desktop-cols, 1fr);
  }
}

@mixin auto-fit-grid($min-width: 280px, $gap: var(--space-4)) {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
  gap: $gap;
}

// Responsive Flexbox
@mixin responsive-flex($mobile-direction: column, $desktop-direction: row) {
  display: flex;
  flex-direction: $mobile-direction;
  gap: var(--space-4);
  
  @include desktop-only {
    flex-direction: $desktop-direction;
  }
}

// Responsive Visibility
@mixin show-mobile-only {
  display: block;
  
  @include tablet-only {
    display: none;
  }
  
  @include desktop-only {
    display: none;
  }
}

@mixin show-desktop-only {
  display: none;
  
  @include desktop-only {
    display: block;
  }
}

@mixin hide-mobile {
  @include mobile-only {
    display: none;
  }
}

@mixin hide-desktop {
  @include desktop-only {
    display: none;
  }
}

// Responsive Images
@mixin responsive-image {
  max-width: 100%;
  height: auto;
  display: block;
}

@mixin aspect-ratio($width, $height) {
  aspect-ratio: $width / $height;
  
  // Fallback for older browsers
  @supports not (aspect-ratio: 1) {
    position: relative;
    
    &::before {
      content: '';
      display: block;
      padding-top: percentage($height / $width);
    }
    
    > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }
}

// Responsive Cards
@mixin responsive-card {
  @include card-base;
  padding: var(--space-4);
  
  @include tablet-only {
    padding: var(--space-5);
  }
  
  @include desktop-only {
    padding: var(--space-6);
  }
}

// Mobile-First Navigation
@mixin mobile-nav {
  @include mobile-only {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: var(--bg-primary);
    z-index: var(--z-modal);
    transform: translateX(-100%);
    transition: transform var(--transition-normal);
    
    &.open {
      transform: translateX(0);
    }
  }
}

// Responsive Tables
@mixin responsive-table {
  width: 100%;
  border-collapse: collapse;
  
  @include mobile-only {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
  }
  
  th, td {
    padding: var(--space-3);
    text-align: left;
    border-bottom: 1px solid var(--border-primary);
    
    @include mobile-only {
      padding: var(--space-2);
      font-size: var(--font-size-sm);
    }
  }
}

// Responsive Modal
@mixin responsive-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
  
  @include mobile-only {
    width: 95%;
    max-height: 95vh;
  }
}

// Touch-Friendly Interactions
@mixin touch-target {
  min-height: 44px;
  min-width: 44px;
  
  @media (pointer: coarse) {
    min-height: 48px;
    min-width: 48px;
  }
}

// Responsive Font Sizes
@mixin heading-responsive {
  &.h1 {
    @include fluid-type(2rem, 3rem);
    font-weight: var(--font-bold);
    line-height: var(--leading-tight);
  }
  
  &.h2 {
    @include fluid-type(1.5rem, 2.25rem);
    font-weight: var(--font-semibold);
    line-height: var(--leading-tight);
  }
  
  &.h3 {
    @include fluid-type(1.25rem, 1.875rem);
    font-weight: var(--font-semibold);
    line-height: var(--leading-normal);
  }
  
  &.h4 {
    @include fluid-type(1.125rem, 1.5rem);
    font-weight: var(--font-medium);
    line-height: var(--leading-normal);
  }
}

// Responsive Sidebar
@mixin responsive-sidebar {
  @include mobile-only {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    width: 280px;
    transform: translateX(-100%);
    transition: transform var(--transition-normal);
    z-index: var(--z-modal);
    
    &.open {
      transform: translateX(0);
    }
  }
  
  @include desktop-only {
    position: relative;
    width: 280px;
    height: 100vh;
    transform: none;
    transition: width var(--transition-normal);
    
    &.collapsed {
      width: 80px;
    }
  }
}

// Responsive Calendar Grid
@mixin calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 1px;
  
  @include mobile-only {
    font-size: var(--font-size-xs);
  }
  
  @include tablet-only {
    font-size: var(--font-size-sm);
  }
}

// Responsive Dashboard Layout
@mixin dashboard-layout {
  display: grid;
  gap: var(--space-4);
  
  @include mobile-only {
    grid-template-columns: 1fr;
  }
  
  @include tablet-only {
    grid-template-columns: repeat(2, 1fr);
  }
  
  @include desktop-only {
    grid-template-columns: repeat(3, 1fr);
  }
}

// Utility function to strip units
@function strip-unit($number) {
  @if type-of($number) == 'number' and not unitless($number) {
    @return $number / ($number * 0 + 1);
  }
  @return $number;
}

// Print Styles
@mixin print-styles {
  @media print {
    * {
      background: transparent !important;
      color: black !important;
      box-shadow: none !important;
      text-shadow: none !important;
    }
    
    a, a:visited {
      text-decoration: underline;
    }
    
    .no-print {
      display: none !important;
    }
    
    .print-only {
      display: block !important;
    }
  }
}

// High Contrast Mode Support
@mixin high-contrast {
  @media (prefers-contrast: high) {
    border: 2px solid;
    background: ButtonFace;
    color: ButtonText;
  }
}

// Reduced Motion Support
@mixin respect-motion-preference {
  @media (prefers-reduced-motion: reduce) {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
