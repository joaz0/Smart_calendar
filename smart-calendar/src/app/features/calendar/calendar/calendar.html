<div class="calendar-container">
  <!-- Calendar Header -->
  <div class="calendar-header">
    <div class="navigation">
      <button mat-icon-button (click)="previousPeriod()" aria-label="Período anterior">
        <mat-icon>chevron_left</mat-icon>
      </button>
      <h2 class="period-title">{{ currentPeriodTitle }}</h2>
      <button mat-icon-button (click)="nextPeriod()" aria-label="Próximo período">
        <mat-icon>chevron_right</mat-icon>
      </button>
      <button mat-button (click)="goToToday()" class="today-btn">Hoje</button>
    </div>

    <div class="view-controls">
      <mat-button-toggle-group [(value)]="currentView" (change)="changeView($event)">
        <mat-button-toggle value="month">Mês</mat-button-toggle>
        <mat-button-toggle value="week">Semana</mat-button-toggle>
        <mat-button-toggle value="day">Dia</mat-button-toggle>
      </mat-button-toggle-group>
    </div>

    <div class="actions">
      <button mat-icon-button [matMenuTriggerFor]="filterMenu" aria-label="Filtros">
        <mat-icon>filter_list</mat-icon>
      </button>
      <button mat-raised-button color="primary" (click)="createEvent()">
        <mat-icon>add</mat-icon>
        Novo Evento
      </button>
    </div>
  </div>

  <!-- Calendar Views -->
  <div class="calendar-content">
    <!-- Month View -->
    @if (currentView === 'month') {
      <app-month-view
        [events]="filteredEvents"
        [selectedDate]="selectedDate"
        (dateSelected)="onDateSelected($event)"
        (eventClicked)="onEventClicked($event)">
      </app-month-view>
    }

    <!-- Week View -->
    @if (currentView === 'week') {
      <app-week-view
        [events]="filteredEvents"
        [selectedDate]="selectedDate"
        (dateSelected)="onDateSelected($event)"
        (eventClicked)="onEventClicked($event)">
      </app-week-view>
    }

    <!-- Day View -->
    @if (currentView === 'day') {
      <app-day-view
        [events]="filteredEvents"
        [selectedDate]="selectedDate"
        (eventClicked)="onEventClicked($event)">
      </app-day-view>
    }
  </div>

  <!-- Filter Menu -->
  <mat-menu #filterMenu="matMenu">
    <div class="filter-content" (click)="$event.stopPropagation()">
      <h3>Filtrar por Categoria</h3>
      @for (category of categories; track category) {
        <mat-checkbox
          [(ngModel)]="category.visible"
          (change)="applyFilters()"
          class="category-filter">
          <span class="category-color" [style.background-color]="category.color"></span>
          {{ category.name }}
        </mat-checkbox>
      }
    </div>
  </mat-menu>
</div>