<div class="event-form">
  <form [formGroup]="eventForm" (ngSubmit)="onSubmit()">
    <!-- Header -->
    <div class="form-header">
      <h2>{{ isEditMode ? 'Editar Evento' : 'Novo Evento' }}</h2>
      <div class="form-actions">
        <button type="button" class="btn-secondary" (click)="onCancel()">Cancelar</button>
        <button type="submit" class="btn-primary" [disabled]="!eventForm.valid">
          {{ isEditMode ? 'Atualizar' : 'Criar' }}
        </button>
      </div>
    </div>

    <!-- Tabs -->
    <div class="form-tabs">
      <button
        type="button"
        class="tab-btn"
        [class.active]="activeTab === 'details'"
        (click)="setActiveTab('details')"
        >
        üìù Detalhes
      </button>
      <button
        type="button"
        class="tab-btn"
        [class.active]="activeTab === 'time'"
        (click)="setActiveTab('time')"
        >
        ‚è∞ Hor√°rio
      </button>
      <button
        type="button"
        class="tab-btn"
        [class.active]="activeTab === 'advanced'"
        (click)="setActiveTab('advanced')"
        >
        ‚öôÔ∏è Avan√ßado
      </button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Detalhes Tab -->
      @if (activeTab === 'details') {
        <div class="tab-pane">
          <div class="form-group">
            <label>T√≠tulo *</label>
            <input
              type="text"
              formControlName="title"
              placeholder="T√≠tulo do evento..."
              class="form-input"
              [class.error]="eventForm.get('title')?.invalid && eventForm.get('title')?.touched"
              />
            @if (eventForm.get('title')?.invalid && eventForm.get('title')?.touched) {
              <div class="error-message">
                T√≠tulo √© obrigat√≥rio
              </div>
            }
          </div>
          <div class="form-group">
            <label>Descri√ß√£o</label>
            <textarea
              formControlName="description"
              placeholder="Descri√ß√£o do evento..."
              class="form-textarea"
              rows="4"
            ></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Categoria</label>
              <app-category-picker
                formControlName="category"
              ></app-category-picker>
            </div>
            <div class="form-group">
              <label>Cor</label>
              <app-color-picker
                formControlName="color"
              ></app-color-picker>
            </div>
          </div>
          <div class="form-group">
            <label>Localiza√ß√£o</label>
            <input
              type="text"
              formControlName="location"
              placeholder="Local do evento..."
              class="form-input"
              />
          </div>
        </div>
      }

      <!-- Hor√°rio Tab -->
      @if (activeTab === 'time') {
        <div class="tab-pane">
          <div class="form-row">
            <div class="form-group">
              <label>Data In√≠cio *</label>
              <input
                placeholder="Data do in√≠cio"
                type="date"
                formControlName="startDate"
                class="form-input"
                [class.error]="eventForm.get('startDate')?.invalid && eventForm.get('startDate')?.touched"
                />
              @if (eventForm.get('startDate')?.invalid && eventForm.get('startDate')?.touched) {
                <div class="error-message">
                  Data de in√≠cio √© obrigat√≥ria
                </div>
              }
            </div>
            <div class="form-group">
              <label>Hora In√≠cio</label>
              @if (!eventForm.get('allDay')?.value) {
                <input
                  placeholder="Hora do in√≠cio"
                  type="time"
                  formControlName="startTime"
                  class="form-input"
                  />
              }
              @if (eventForm.get('allDay')?.value) {
                <div class="all-day-text">
                  Dia todo
                </div>
              }
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Data Fim *</label>
              <input
                placeholder="Data do t√©rmino"
                type="date"
                formControlName="endDate"
                class="form-input"
                [class.error]="eventForm.get('endDate')?.invalid && eventForm.get('endDate')?.touched"
                />
              @if (eventForm.get('endDate')?.invalid && eventForm.get('endDate')?.touched) {
                <div class="error-message">
                  Data de fim √© obrigat√≥ria
                </div>
              }
            </div>
            <div class="form-group">
              <label>Hora Fim</label>
              @if (!eventForm.get('allDay')?.value) {
                <input
                  placeholder="Hora do t√©rmino"
                  type="time"
                  formControlName="endTime"
                  class="form-input"
                  />
              }
              @if (eventForm.get('allDay')?.value) {
                <div class="all-day-text">
                  Dia todo
                </div>
              }
            </div>
          </div>
          <div class="form-group">
            <label class="checkbox-label">
              <input
                type="checkbox"
                formControlName="allDay"
                class="checkbox"
                />
              <span class="checkmark"></span>
              Evento de dia todo
            </label>
          </div>
          @if (!eventForm.get('allDay')?.value) {
            <div class="form-group">
              <label>Dura√ß√£o</label>
              <div class="duration-display">
              </div>
            </div>
          }
          <!-- Recorr√™ncia -->
          <div class="form-group">
            <label class="checkbox-label">
              <input
                type="checkbox"
                formControlName="isRecurring"
                class="checkbox"
                />
              <span class="checkmark"></span>
              Evento recorrente
            </label>
          </div>
          @if (eventForm.get('isRecurring')?.value) {
            <div class="recurrence-settings">
              <!-- Placeholder para recorr√™ncia -->
              <div class="form-group">
                <label>Frequ√™ncia</label>
                <select class="form-select">
                  <option value="daily">Diariamente</option>
                  <option value="weekly">Semanalmente</option>
                  <option value="monthly">Mensalmente</option>
                  <option value="yearly">Anualmente</option>
                </select>
              </div>
            </div>
          }
        </div>
      }

      <!-- Avan√ßado Tab -->
      @if (activeTab === 'advanced') {
        <div class="tab-pane">
          <!-- Lembretes -->
          <div class="form-group">
            <label>Lembretes</label>
            <div class="reminders-list">
              @for (reminder of reminders.controls; track reminder; let i = $index) {
                <div
                  class="reminder-item"
                  [formGroupName]="i"
                  >
                  <select
                    formControlName="minutesBefore"
                    class="form-select"
                    >
                    <option value="5">5 minutos antes</option>
                    <option value="15">15 minutos antes</option>
                    <option value="30">30 minutos antes</option>
                    <option value="60">1 hora antes</option>
                    <option value="1440">1 dia antes</option>
                  </select>
                  <select
                    formControlName="type"
                    class="form-select"
                    >
                    <option value="notification">Notifica√ß√£o</option>
                    <option value="email">E-mail</option>
                    <option value="sound">Alerta sonoro</option>
                  </select>
                  <button
                    type="button"
                    class="btn-remove"
                    (click)="removeReminder(i)"
                    >
                    üóëÔ∏è
                  </button>
                </div>
              }
            </div>
            <button
              type="button"
              class="btn-add"
              (click)="addReminder()"
              >
              + Adicionar Lembrete
            </button>
          </div>
          <!-- Disponibilidade -->
          <div class="form-group">
            <label>Disponibilidade</label>
            <select formControlName="availability" class="form-select">
              <option value="busy">Ocupado</option>
              <option value="free">Livre</option>
              <option value="tentative">Talvez</option>
              <option value="outofoffice">Fora do escrit√≥rio</option>
            </select>
          </div>
          <!-- Links R√°pidos -->
          <div class="form-group">
            <label>Links da Reuni√£o</label>
            <div class="quick-links">
              <input
                type="url"
                formControlName="meetingLink"
                placeholder="Link da videochamada..."
                class="form-input"
                />
              <input
                type="url"
                formControlName="documentLink"
                placeholder="Link do documento..."
                class="form-input"
                />
            </div>
          </div>
          <!-- Privacidade -->
          <div class="form-group">
            <label class="checkbox-label">
              <input
                type="checkbox"
                formControlName="isPrivate"
                class="checkbox"
                />
              <span class="checkmark"></span>
              Evento privado (apenas eu posso ver os detalhes)
            </label>
          </div>
        </div>
      }
    </div>

    <!-- AI Suggestions -->
    @if (showAISuggestions) {
      <div class="ai-suggestions">
        <div class="suggestions-header">
          <h4>ü§ñ Sugest√µes da IA</h4>
          <button type="button" class="btn-close" (click)="hideAISuggestions()">√ó</button>
        </div>
        <div class="suggestion-list">
          <div class="suggestion-item">
            <div class="suggestion-text">Sugerir hor√°rios dispon√≠veis</div>
            <button type="button" class="btn-suggestion">Aplicar</button>
          </div>
          <div class="suggestion-item">
            <div class="suggestion-text">Adicionar template de reuni√£o</div>
            <button type="button" class="btn-suggestion">Aplicar</button>
          </div>
        </div>
      </div>
    }
  </form>
</div>