<div class="ai-assistant">
  <div class="ai-header">
    <div class="header-content">
      <h1>
        <mat-icon>smart_toy</mat-icon>
        Assistente IA
      </h1>
      <p>Seu assistente inteligente para produtividade e organização</p>
    </div>
    
    <div class="header-actions">
      <button mat-raised-button color="accent" (click)="analyzeProductivity()">
        <mat-icon>analytics</mat-icon>
        Analisar Produtividade
      </button>
      <button mat-raised-button color="primary" (click)="optimizeSchedule()">
        <mat-icon>auto_fix_high</mat-icon>
        Otimizar Agenda
      </button>
      <button mat-icon-button (click)="clearChat()" matTooltip="Limpar conversa">
        <mat-icon>delete_sweep</mat-icon>
      </button>
    </div>
  </div>

  <div class="ai-content">
    <div class="chat-container">
      <div class="chat-messages" #messagesContainer>
        <div *ngFor="let message of messages" 
             class="message"
             [class.user]="message.isUser"
             [class.ai]="!message.isUser">
          <mat-icon>{{ message.isUser ? 'person' : 'smart_toy' }}</mat-icon>
          <div>
            <div class="message-content">{{ message.text }}</div>
            <div class="timestamp">{{ message.timestamp | date:'short' }}</div>
          </div>
        </div>

        <div class="loading-indicator" *ngIf="loading">
          <mat-spinner diameter="24"></mat-spinner>
          <span>Processando...</span>
        </div>
      </div>

      <div class="quick-actions">
        <button *ngFor="let action of quickActions"
                (click)="quickAction(action.id)"
                [disabled]="loading">
          <mat-icon>{{ action.icon }}</mat-icon>
          {{ action.label }}
        </button>
      </div>

      <div class="chat-input">
        <input type="text"
               [(ngModel)]="currentMessage"
               (keydown.enter)="sendMessage()"
               [disabled]="loading"
               placeholder="Digite sua mensagem ou comando..."
               aria-label="Campo de mensagem">
        <button (click)="sendMessage()" 
                [disabled]="!currentMessage.trim() || loading"
                aria-label="Enviar mensagem">
          <mat-icon>send</mat-icon>
        </button>
      </div>
    </div>

    <div class="suggestions-panel">
      <div class="suggestions-header">
        <h3>
          <mat-icon>lightbulb</mat-icon>
          Sugestões Inteligentes
        </h3>
        <button mat-icon-button (click)="loadSuggestions()" matTooltip="Atualizar sugestões">
          <mat-icon>refresh</mat-icon>
        </button>
      </div>

      <div class="suggestions-list">
        <div class="loading-suggestions" *ngIf="loadingSuggestions">
          <mat-spinner diameter="32"></mat-spinner>
          <span>Carregando sugestões...</span>
        </div>

        <div *ngIf="!loadingSuggestions && suggestions.length === 0" class="no-suggestions">
          <mat-icon>lightbulb_outline</mat-icon>
          <p>Nenhuma sugestão no momento</p>
        </div>

        <div *ngFor="let suggestion of suggestions"
             class="suggestion-card"
             (click)="executeSuggestion(suggestion)">
          <div class="suggestion-header">
            <div class="suggestion-title">
              <mat-icon>{{ getSuggestionIcon(suggestion.type) }}</mat-icon>
              {{ suggestion.title }}
            </div>
            <span class="priority-badge"
                  [style.background]="getSuggestionColor(suggestion.priority)"
                  [style.color]="'white'">
              {{ suggestion.priority }}
            </span>
          </div>
          <p class="suggestion-description">{{ suggestion.description }}</p>
        </div>
      </div>

      <div class="quick-analytics">
        <h4 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 0.95rem;">Ações Rápidas</h4>
        <button (click)="analyzeProductivity()">
          <mat-icon>analytics</mat-icon>
          Analisar Produtividade
        </button>
        <button (click)="optimizeSchedule()">
          <mat-icon>event_available</mat-icon>
          Otimizar Agenda
        </button>
        <button (click)="quickAction('focus')">
          <mat-icon>center_focus_strong</mat-icon>
          Ativar Modo Foco
        </button>
      </div>
    </div>
  </div>
</div>
