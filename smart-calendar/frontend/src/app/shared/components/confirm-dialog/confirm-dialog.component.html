<div class="confirm-dialog">
  <div class="dialog-header">
    <div class="dialog-icon" [class]="'icon-' + type">
      <mat-icon [class]="'icon-' + type">{{ getIcon() }}</mat-icon>
    </div>
    <h2 id="confirm-dialog-title">{{ title }}</h2>
  </div>

  <div class="dialog-content">
    <div class="message-content">
      <p class="primary-message">{{ message }}</p>
      @if (details) {
        <p class="secondary-message">{{ details }}</p>
      }

      @if (type === 'warning' || type === 'danger') {
        <div class="warning-box">
          <mat-icon>warning</mat-icon>
          <span>Esta ação não pode ser desfeita</span>
        </div>
      }

      @if (additionalInfo && additionalInfo.length > 0) {
        <div class="info-list">
          <h4>Informações adicionais:</h4>
          <ul>
            @for (info of additionalInfo; track info) {
              <li>{{ info }}</li>
            }
          </ul>
        </div>
      }

      @if (requireConfirmation) {
        <div class="confirmation-input">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Digite "{{ confirmationText }}" para confirmar</mat-label>
            <input matInput
              [(ngModel)]="userConfirmation"
              (input)="onConfirmationInput()"
              [placeholder]="confirmationText"
              autocomplete="off">
            @if (showConfirmationError) {
              <mat-error>
                Texto de confirmação não confere
              </mat-error>
            }
          </mat-form-field>
        </div>
      }

      @if (checkboxOptions && checkboxOptions.length > 0) {
        <div class="checkbox-options">
          @for (option of checkboxOptions; track trackByOption($index, option)) {
            <mat-checkbox
              [(ngModel)]="option.checked"
              [disabled]="option.disabled || false">
              {{ option.label }}
            </mat-checkbox>
          }
        </div>
      }
    </div>
  </div>

  <div class="dialog-actions">
    <button mat-button
      (click)="onCancel()"
      [disabled]="isProcessing"
      class="cancel-btn">
      {{ cancelText || 'Cancelar' }}
    </button>

    <button mat-raised-button
      [color]="getConfirmButtonColor()"
      (click)="onConfirm()"
      [disabled]="!canConfirm() || isProcessing"
      class="confirm-btn">
      @if (isProcessing) {
        <mat-spinner diameter="20"></mat-spinner>
      }
      @if (!isProcessing) {
        <mat-icon>{{ getConfirmIcon() }}</mat-icon>
      }
      <span>{{ isProcessing ? 'Processando...' : (confirmText || 'Confirmar') }}</span>
    </button>
  </div>
</div>
