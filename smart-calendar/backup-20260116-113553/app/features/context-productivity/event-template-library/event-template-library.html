<div class="template-library-container">
  <div class="header">
    <h2>
      <mat-icon>description</mat-icon>
      Biblioteca de Templates
    </h2>
    <button mat-raised-button color="primary">
      <mat-icon>add</mat-icon>
      Novo Template
    </button>
  </div>

  <div class="filters">
    <mat-form-field appearance="outline" class="search-field">
      <mat-icon matPrefix>search</mat-icon>
      <input matInput [(ngModel)]="searchTerm" (input)="onSearch()" placeholder="Buscar templates...">
    </mat-form-field>

    <mat-form-field appearance="outline" class="category-select">
      <mat-label>Categoria</mat-label>
      <mat-select [(ngModel)]="selectedCategory" (selectionChange)="onCategoryChange()">
        @for (cat of categories; track cat) {
          <mat-option [value]="cat.value">
            {{cat.label}}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  <div class="templates-grid">
    @for (template of filteredTemplates; track trackByTemplate($index, template)) {
      <mat-card class="template-card">
        <mat-card-header>
          <div class="template-header">
            <div class="template-title-section">
              <h3>{{template.name}}</h3>
              <mat-chip [style.background-color]="getCategoryColor(template.category)" style="color: white;">
                {{getCategoryLabel(template.category)}}
              </mat-chip>
            </div>
            @if (template.isDefault) {
              <span class="default-badge">
                <mat-icon>star</mat-icon>
                Padr√£o
              </span>
            }
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="template-info">
            @if (template.description) {
              <p class="description">{{template.description}}</p>
            }
            <div class="meta-info">
              <span class="meta-item">
                <mat-icon>schedule</mat-icon>
                {{template.duration}} min
              </span>
              @if (template.location) {
                <span class="meta-item">
                  <mat-icon>location_on</mat-icon>
                  {{template.location}}
                </span>
              }
              <span class="meta-item">
                <mat-icon>repeat</mat-icon>
                {{template.usageCount}} usos
              </span>
            </div>
            @if (template.reminders && template.reminders.length > 0) {
              <div class="reminders">
                <mat-icon>notifications</mat-icon>
                <span>Lembretes: {{template.reminders.join(', ')}} min antes</span>
              </div>
            }
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary" (click)="useTemplate(template)">
            <mat-icon>add_circle</mat-icon>
            Usar
          </button>
          <button mat-icon-button (click)="editTemplate(template)">
            <mat-icon>edit</mat-icon>
          </button>
          @if (!template.isDefault) {
            <button mat-icon-button color="warn" (click)="deleteTemplate(template)">
              <mat-icon>delete</mat-icon>
            </button>
          }
        </mat-card-actions>
      </mat-card>
    }

    @if (filteredTemplates.length === 0) {
      <div class="no-templates">
        <mat-icon>inbox</mat-icon>
        <p>Nenhum template encontrado</p>
      </div>
    }
  </div>
</div>
